- platform: mqtt
  name: Sonoff Basic 01 Version
  state_topic: "homeassistant/switch/light-lamp-salon/stat/STATUS2"
  value_template: "{{ value_json['StatusFWR'].Version }}"

- platform: mqtt
  name: Sonoff Basic 02 Version
  state_topic: "homeassistant/switch/light-leds-przedpokoj/stat/STATUS2"
  value_template: "{{ value_json['StatusFWR'].Version }}"

- platform: rest
  name: Sonoff Version Current
  resource: https://api.github.com/repos/arendst/Sonoff-Tasmota/releases/latest
  value_template: "{{ value_json.tag_name | replace('v', '') }}"
  username: !secret github_username
  password: !secret github_token_access
  authentication: basic
  scan_interval: 7200
  headers:
    Accept: application/vnd.github.v3+json
    Content-Type: application/json
    User-Agent: Home Assistant REST sensor

- platform: nut
  name: UPS
  host: !secret ups_host
  alias: ups
  resources:
    - ups.status
    - ups.load
    - input.voltage
    - battery.runtime
    - battery.voltage
    - battery.charge

- platform: cert_expiry
  host: !secret http_base_url

- platform: command_line
  name: Raspberry CPU Temp
  command: "cat /sys/class/thermal/thermal_zone0/temp"
  unit_of_measurement: "°C"
  value_template: '{{ (value | multiply(0.001)) | round(1) }}'
  scan_interval: 300

- platform: command_line
  name: Last restart
  command: "systemctl status home-assistant.service | head -3 | awk '{print $6}' | tail -1"
  scan_interval: 1800

- platform: command_line
  command: python3 -c "import requests; print(requests.get('https://pypi.python.org/pypi/homeassistant/json').json()['info']['version'])"
  name: HA Version Current
  scan_interval: 1800

- platform: sql
  db_url: !secret mysql_db_url
  queries:
    - name: HA Database Size
      query: 'SELECT table_schema "database", Round(Sum(data_length + index_length) / 1024 / 1024, 1) "value" FROM information_schema.tables WHERE table_schema="homeassistant_db" GROUP BY table_schema;'
      column: 'value'
      unit_of_measurement: MB

- platform: version
  name: HA Version Installed

- platform: uptime
  name: Home Assistant Uptime
  unit_of_measurement: minutes

- platform: google_travel_time
  name: Edyta To Home
  api_key: !secret google_api_key
  origin: device_tracker.edyta_iphone
  destination: zone.home

- platform: google_travel_time
  name: Maciek To Home
  api_key: !secret google_api_key
  origin: device_tracker.maciek_gps_bt
  destination: zone.home

- platform: systemmonitor
  resources:
    - type: disk_use_percent
      arg: /
    - type: memory_use_percent
    - type: processor_use
    - type: last_boot

- platform: darksky
  api_key: !secret darksky_api_key
  update_inverval:
    minutes: 15
  language: 'pl'
  monitored_conditions:
    - summary
    - icon
    - wind_speed
    - precip_probability

- platform: speedtest
  hour:
    - 0
    - 4
    - 8
    - 12
    - 16
    - 20
  monitored_conditions:
    - ping
    - download
    - upload
  server: 9399

- platform: min_max
  type: mean
  name: Temperature Indoor
  entity_ids:
    - sensor.temperature_salon
    - sensor.temperature_antresola
    - sensor.temperature_gabinet
    - sensor.temperature_antek
    - sensor.temperature_sypialnia
    - sensor.temperature_lazienka
    - sensor.temperature_goscinny
    - sensor.temperature_pracownia
  round_digits: 1

- platform: min_max
  type: mean
  name: Humidity Indoor
  entity_ids:
    - sensor.humidity_salon
    - sensor.humidity_antresola
    - sensor.humidity_gabinet
    - sensor.humidity_antek
    - sensor.humidity_sypialnia
    - sensor.humidity_lazienka
    - sensor.humidity_goscinny
    - sensor.humidity_pracownia
  round_digits: 0

- platform: template
  sensors:
    printer_status_custom:
      friendly_name: Status drukarki
      value_template: >-
         {% if states.sensor.printer_status %}
            {% if states.sensor.printer_status.state == 'drukowanie' %}
               drukowanie
            {% elif 'prosz' in states.sensor.printer_status.state %}
               nagrzewanie
            {% elif states.sensor.printer_status.state == 'gotowa' %}
               gotowa
            {% elif 'toneru' in states.sensor.printer_status.state or states.sensor.printer_status.state == 'oczekiwanie' %}
               uśpiona
            {% elif 'wymie' in states.sensor.printer_status.state %}
               brak toneru
            {% else %}
               {{ states.sensor.printer_status.state }}
            {% endif %}
         {% else %}
            unknown
         {% endif %}

    printer_counter_custom:
      friendly_name: 'Wydrukowano'
      unit_of_measurement: 'str'
      value_template: >-
         {% if states.sensor.printer_counter %}
            {{ states.sensor.printer_counter.state }}
         {% else %}
           {{ states.sensor.printer_counter_custom.state }}
         {% endif %}

    printer_drum_usage_custom:
      friendly_name: 'Zużycie bębna'
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.printer_drum_usage %}
            {{ states.sensor.printer_drum_usage.state }}
         {% else %}
            {{ states.sensor.printer_drum_usage_custom.state }}
         {% endif %}

    printer_toner_custom:
      friendly_name: 'Pozostały toner'
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.printer_toner %}
            {{ states.sensor.printer_toner.state }}
         {% else %}
            {{ states.sensor.printer_toner_custom.state }}
         {% endif %}

    temperature_kuchnia:
      friendly_name: Temperatura
      unit_of_measurement: '°C'
      value_template: >-
         {% if states.sensor.temperature_salon %}
            {% if states.sensor.temperature_salon.state != 'unknown' %}
               {{ states.sensor.temperature_salon.state | float | round(1) }}
            {% else %}
               {{ states.sensor.temperature_kuchnia.state }}
            {% endif %}
         {% else %}
            {{ states.sensor.temperature_kuchnia.state }}
         {% endif %}

    battery_thermostat_antresola:
      friendly_name: antresola
      unit_of_measurement: '%'
      value_template: >-
         {% if states.zwave.thermostat_antresola.attributes.battery_level %}
            {{ states.zwave.thermostat_antresola.attributes.battery_level }}
         {% else %}
            {{ states.sensor.battery_thermostat_antresola.state }}
         {% endif %}

      icon_template: >-
         {% if states.zwave.thermostat_antresola.attributes.battery_level %}
            {% if states.zwave.thermostat_antresola.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.zwave.thermostat_antresola.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_thermostat_lazienka:
      friendly_name: łazienka
      unit_of_measurement: '%'
      value_template: >-
         {% if states.zwave.thermostat_lazienka.attributes.battery_level %}
            {{ states.zwave.thermostat_lazienka.attributes.battery_level }}
         {% else %}
            {{ states.sensor.battery_thermostat_lazienka.state }}
         {% endif %}

      icon_template: >-
         {% if states.zwave.thermostat_lazienka.attributes.battery_level %}
            {% if states.zwave.thermostat_lazienka.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.zwave.thermostat_lazienka.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_thermostat_salon:
      friendly_name: salon
      unit_of_measurement: '%'
      value_template: >-
         {% if states.zwave.thermostat_salon.attributes.battery_level %}
            {{ states.zwave.thermostat_salon.attributes.battery_level }}
         {% else %}
            {{ states.sensor.battery_thermostat_salon.state }}
         {% endif %}

      icon_template: >-
         {% if states.zwave.thermostat_salon.attributes.battery_level %}
            {% if states.zwave.thermostat_salon.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.zwave.thermostat_salon.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_thermostat_kuchnia:
      friendly_name: kuchnia
      unit_of_measurement: '%'
      value_template: >-
         {% if states.zwave.thermostat_kuchnia.attributes.battery_level %}
            {{ states.zwave.thermostat_kuchnia.attributes.battery_level }}
         {% else %}
            {{ states.sensor.battery_thermostat_kuchnia.state }}
         {% endif %}

      icon_template: >-
         {% if states.zwave.thermostat_kuchnia.attributes.battery_level %}
            {% if states.zwave.thermostat_kuchnia.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.zwave.thermostat_kuchnia.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_thermostat_sypialnia:
      friendly_name: sypialnia
      unit_of_measurement: '%'
      value_template: >-
         {% if states.zwave.thermostat_sypialnia.attributes.battery_level %}
            {{ states.zwave.thermostat_sypialnia.attributes.battery_level }}
         {% else %}
            {{ states.sensor.battery_thermostat_sypialnia.state }}
         {% endif %}

      icon_template: >-
         {% if states.zwave.thermostat_sypialnia.attributes.battery_level %}
            {% if states.zwave.thermostat_sypialnia.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.zwave.thermostat_sypialnia.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_thermostat_antek:
      friendly_name: pokój Antka
      unit_of_measurement: '%'
      value_template: >-
         {% if states.zwave.thermostat_antek.attributes.battery_level %}
            {{ states.zwave.thermostat_antek.attributes.battery_level }}
         {% else %}
            {{ states.sensor.battery_thermostat_antek.state }}
         {% endif %}

      icon_template: >-
         {% if states.zwave.thermostat_antek.attributes.battery_level %}
            {% if states.zwave.thermostat_antek.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.zwave.thermostat_antek.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_temp_humi_sensor_outdoor:
      friendly_name: zewnętrzny
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.temperature_outdoor.attributes.battery_level %}
            {{ states.sensor.temperature_outdoor.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_temp_humi_sensor_outdoor.state }}
         {% endif %}

      icon_template: >-
         {% if states.sensor.temperature_outdoor.attributes.battery_level %}
            {% if states.sensor.temperature_outdoor.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.sensor.temperature_outdoor.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_temp_humi_sensor_pracownia:
      friendly_name: pracownia
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.temperature_pracownia.attributes.battery_level %}
            {{ states.sensor.temperature_pracownia.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_temp_humi_sensor_pracownia.state }}
         {% endif %}

      icon_template: >-
         {% if states.sensor.temperature_pracownia.attributes.battery_level %}
            {% if states.sensor.temperature_pracownia.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.sensor.temperature_pracownia.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_temp_humi_sensor_antek:
      friendly_name: pokój Antka
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.temperature_antek.attributes.battery_level %}
            {{ states.sensor.temperature_antek.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_temp_humi_sensor_antek.state }}
         {% endif %}

      icon_template: >-
         {% if states.sensor.temperature_antek.attributes.battery_level %}
            {% if states.sensor.temperature_antek.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.sensor.temperature_antek.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_temp_humi_sensor_salon:
      friendly_name: salon
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.temperature_salon.attributes.battery_level %}
            {{ states.sensor.temperature_salon.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_temp_humi_sensor_salon.state }}
         {% endif %}

      icon_template: >-
         {% if states.sensor.temperature_salon.attributes.battery_level %}
            {% if states.sensor.temperature_salon.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.sensor.temperature_salon.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_temp_humi_sensor_goscinny:
      friendly_name: pokój gościnny
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.temperature_goscinny.attributes.battery_level %}
            {{ states.sensor.temperature_goscinny.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_temp_humi_sensor_goscinny.state }}
         {% endif %}

      icon_template: >-
         {% if states.sensor.temperature_goscinny.attributes.battery_level %}
            {% if states.sensor.temperature_goscinny.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.sensor.temperature_goscinny.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_temp_humi_sensor_sypialnia:
      friendly_name: sypialnia
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.temperature_sypialnia.attributes.battery_level %}
            {{ states.sensor.temperature_sypialnia.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_temp_humi_sensor_sypialnia.state }}
         {% endif %}

      icon_template: >-
         {% if states.sensor.temperature_sypialnia.attributes.battery_level %}
            {% if states.sensor.temperature_sypialnia.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.sensor.temperature_sypialnia.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_temp_humi_sensor_lazienka:
      friendly_name: łazienka
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.temperature_lazienka.attributes.battery_level %}
            {{ states.sensor.temperature_lazienka.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_temp_humi_sensor_lazienka.state }}
         {% endif %}

      icon_template: >-
         {% if states.sensor.temperature_lazienka.attributes.battery_level %}
            {% if states.sensor.temperature_lazienka.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.sensor.temperature_lazienka.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_temp_humi_sensor_antresola:
      friendly_name: antresola
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.temperature_antresola.attributes.battery_level %}
            {{ states.sensor.temperature_antresola.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_temp_humi_sensor_antresola.state }}
         {% endif %}

      icon_template: >-
         {% if states.sensor.temperature_antresola.attributes.battery_level %}
            {% if states.sensor.temperature_antresola.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.sensor.temperature_antresola.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_temp_humi_sensor_gabinet:
      friendly_name: gabinet
      unit_of_measurement: '%'
      value_template: >-
         {% if states.sensor.temperature_gabinet.attributes.battery_level %}
            {{ states.sensor.temperature_gabinet.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_temp_humi_sensor_gabinet.state }}
         {% endif %}

      icon_template: >-
         {% if states.sensor.temperature_gabinet.attributes.battery_level %}
            {% if states.sensor.temperature_gabinet.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.sensor.temperature_gabinet.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_body_sensor_antresola:
      friendly_name: antresola
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.motion_antresola_1.attributes.battery_level %}
            {{ states.binary_sensor.motion_antresola_1.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_body_sensor_atresola.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.motion_antresola_1.attributes.battery_level %}
            {% if states.binary_sensor.motion_antresola_1.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.motion_antresola_1.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_body_sensor_przedpokoj:
      friendly_name: przedpokoj
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.motion_przedpokoj.attributes.battery_level %}
            {{ states.binary_sensor.motion_przedpokoj.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_body_sensor_przedpokoj.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.motion_przedpokoj.attributes.battery_level %}
            {% if states.binary_sensor.motion_przedpokoj.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.motion_przedpokoj.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_body_sensor_schody:
      friendly_name: schody
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.motion_antresola_2.attributes.battery_level %}
            {{ states.binary_sensor.motion_antresola_2.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_body_sensor_schody.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.motion_antresola_2.attributes.battery_level %}
            {% if states.binary_sensor.motion_antresola_2.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.motion_antresola_2.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_body_sensor_salon_1:
      friendly_name: salon [1]
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.motion_salon_1.attributes.battery_level %}
            {{ states.binary_sensor.motion_salon_1.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_body_sensor_salon_1.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.motion_salon_1.attributes.battery_level %}
            {% if states.binary_sensor.motion_salon_1.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.motion_salon_1.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_body_sensor_sypialnia:
      friendly_name: sypialnia
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.motion_sypialnia.attributes.battery_level %}
            {{ states.binary_sensor.motion_sypialnia.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_body_sensor_sypialnia.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.motion_sypialnia.attributes.battery_level %}
            {% if states.binary_sensor.motion_sypialnia.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.motion_sypialnia.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_body_sensor_antek:
      friendly_name: pokój Antka
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.motion_antek.attributes.battery_level %}
            {{ states.binary_sensor.motion_antek.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_body_sensor_antek.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.motion_antek.attributes.battery_level %}
            {% if states.binary_sensor.motion_antek.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.motion_antek.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_body_sensor_salon_2:
      friendly_name: salon [2]
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.motion_salon_2.attributes.battery_level %}
            {{ states.binary_sensor.motion_salon_2.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_body_sensor_salon_2.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.motion_salon_2.attributes.battery_level %}
            {% if states.binary_sensor.motion_salon_2.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.motion_salon_2.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_switch_light_salon_1:
      friendly_name: salon [1]
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.switch_light_salon_1.attributes.battery_level %}
            {{ states.binary_sensor.switch_light_salon_1.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_switch_light_salon_1.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.switch_light_salon_1.attributes.battery_level %}
            {% if states.binary_sensor.switch_light_salon_1.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.switch_light_salon_1.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_switch_light_salon_2:
      friendly_name: salon [2]
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.switch_light_salon_2.attributes.battery_level %}
            {{ states.binary_sensor.switch_light_salon_2.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_switch_light_salon_2.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.switch_light_salon_2.attributes.battery_level %}
            {% if states.binary_sensor.switch_light_salon_2.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.switch_light_salon_2.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_switch_light_antek:
      friendly_name: pokój Antka
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.switch_light_antek.attributes.battery_level %}
            {{ states.binary_sensor.switch_light_antek.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_switch_light_antek.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.switch_light_antek.attributes.battery_level %}
            {% if states.binary_sensor.switch_light_antek.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.switch_light_antek.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_window_sensor_kuchnia:
      friendly_name: kuchnia
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.window_kuchnia.attributes.battery_level %}
            {{ states.binary_sensor.window_kuchnia.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_window_sensor_kuchnia.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.window_kuchnia.attributes.battery_level %}
            {% if states.binary_sensor.window_kuchnia.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.window_kuchnia.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_door_sensor_sypialnia:
      friendly_name: sypialnia
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.balcony_door_sypialnia.attributes.battery_level %}
            {{ states.binary_sensor.balcony_door_sypialnia.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_door_sensor_sypialnia.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.balcony_door_sypialnia.attributes.battery_level %}
            {% if states.binary_sensor.balcony_door_sypialnia.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.balcony_door_sypialnia.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    battery_door_sensor_pracownia:
      friendly_name: pracownia
      unit_of_measurement: '%'
      value_template: >-
         {% if states.binary_sensor.balcony_door_pracownia.attributes.battery_level %}
            {{ states.binary_sensor.balcony_door_pracownia.attributes.battery_level | round }}
         {% else %}
            {{ states.sensor.battery_door_sensor_pracownia.state }}
         {% endif %}

      icon_template: >-
         {% if states.binary_sensor.balcony_door_pracownia.attributes.battery_level %}
            {% if states.binary_sensor.balcony_door_pracownia.attributes.battery_level != 'unknown' %}
               {% set battery = ['-outline','-10','-20','-30','-40','-50','-60','-70','-80','-90','-100'] %}
               {% set charge = (states.binary_sensor.balcony_door_pracownia.attributes.battery_level | float / 10) | round %}
               mdi:battery{{ battery[charge] }}
            {% else %}
               mdi:battery-unknown
            {% endif %}
         {% else %}
            mdi:battery-unknown
         {% endif %}

    edyta_presence:
      friendly_name: Edyta
      value_template: >-
         {% if is_state('device_tracker.edyta_iphone', 'work') %}
            w pracy
         {% elif is_state('device_tracker.edyta_iphone', 'home') %}
            w domu
         {% elif is_state('device_tracker.edyta', 'home') %}
            w domu
         {% else %}
            poza domem
         {% endif %}

    maciek_presence:
      friendly_name: Maciek
      value_template: >-
         {% if is_state('device_tracker.maciek_gps_bt', 'work') %}
            w pracy
         {% elif is_state('device_tracker.maciek_gps_bt', 'home') %}
            w domu
         {% elif is_state('device_tracker.maciek', 'home') %}
            w domu
         {% else %}
            poza domem
         {% endif %}

    jerzy_presence:
      friendly_name: Jerzy
      value_template: >-
         {% if is_state('device_tracker.jerzy_bt', 'home') %}
            w domu
         {% elif is_state('device_tracker.jerzy', 'home') %}
            w domu
         {% else %}
            poza domem
         {% endif %}

    romana_presence:
      friendly_name: Romana
      value_template: >-
         {% if is_state('device_tracker.romana_bt', 'home') %}
            w domu
         {% elif is_state('device_tracker.romana', 'home') %}
            w domu
         {% else %}
            poza domem
         {% endif %}

    emil_presence:
      friendly_name: Emil
      value_template: >-
         {% if is_state('device_tracker.emi_bt', 'home') %}
            w domu
         {% elif is_state('device_tracker.emil', 'home') %}
            w domu
         {% else %}
            poza domem
         {% endif %}

    grazyna_presence:
      friendly_name: Grażyna
      value_template: >-
         {% if is_state('device_tracker.grazyna_bt', 'home') %}
            w domu
         {% elif is_state('device_tracker.grazyna', 'home') %}
            w domu
         {% else %}
            poza domem
         {% endif %}

    agnieszka_presence:
      friendly_name: Agnieszka
      value_template: >-
         {% if is_state('device_tracker.agnieszka_bt', 'home') %}
            w domu
         {% elif is_state('device_tracker.agnieszka', 'home') %}
            w domu
         {% else %}
            poza domem
         {% endif %}

    sun_custom:
      friendly_name: Pozycja słońca
      value_template: >-
         {% if states.sun.sun %}
            {% if states.sun.sun.state == 'above_horizon' %}
               ponad horyzontem
            {% else %}
               poniżej horyzontu
            {% endif %}
         {% else %}
            unknown
         {% endif %}

      icon_template: >-
         {% if states.sun.sun %}
            {% if states.sun.sun.state == 'above_horizon' %}
               mdi:weather-sunny
            {% else %}
               mdi:weather-night
            {% endif %}
         {% else %}
            mdi:help-circle
         {% endif %}

    sunrise:
      friendly_name: Wschód słońca
      value_template: >-
         {% if states.sun.sun %}
            {{ as_timestamp(states.sun.sun.attributes.next_rising) | timestamp_custom("%H:%M") }}
         {% else %}
            {{ states.sensor.sunrise.state }}
         {% endif %}

    sunset:
      friendly_name: Zachód słońca
      value_template: >-
         {% if states.sun.sun %}
            {{ as_timestamp(states.sun.sun.attributes.next_setting) | timestamp_custom("%H:%M") }}
         {% else %}
            {{ states.sensor.sunset.state }}
         {% endif %}

    dark_sky_summary_custom:
      friendly_name: Warunki pogodowe
      value_template: >-
         {% if states.sensor.dark_sky_summary %}
            {{ states.sensor.dark_sky_summary.state | lower }}
         {% else %}
            {{ states.sensor.dark_sky_summary.state }}
         {% endif %}

      icon_template: >-
         {% if states.sensor.dark_sky_summary and states.sensor.dark_sky_icon %}
            {% if states.sensor.dark_sky_icon.state == 'sleet' %}
               mdi:weather-snowy-rainy
            {% elif states.sensor.dark_sky_icon.state == 'thunderstorm' %}
               mdi:weather-lightning-rainy
            {% elif states.sensor.dark_sky_summary.attributes.entity_picture == '/static/images/darksky/weather-sunny.svg' %}
               mdi:weather-sunny
            {% elif states.sensor.dark_sky_summary.attributes.entity_picture == '/static/images/darksky/weather-night.svg' %}
               mdi:weather-night
            {% elif states.sensor.dark_sky_summary.attributes.entity_picture == '/static/images/darksky/weather-pouring.svg' %}
               mdi:weather-pouring
            {% elif states.sensor.dark_sky_summary.attributes.entity_picture == '/static/images/darksky/weather-snowy.svg' %}
               mdi:weather-snowy
            {% elif states.sensor.dark_sky_summary.attributes.entity_picture == '/static/images/darksky/weather-hail.svg' %}
               mdi:weather-hail
            {% elif states.sensor.dark_sky_summary.attributes.entity_picture == '/static/images/darksky/weather-windy.svg' %}
               mdi:weather-windy
            {% elif states.sensor.dark_sky_summary.attributes.entity_picture == 'static/images/darksky/weather-fog.svg' %}
               mdi:weather-fog
            {% elif states.sensor.dark_sky_summary.attributes.entity_picture == '/static/images/darksky/weather-cloudy.svg' %}
               mdi:weather-cloudy
            {% elif states.sensor.dark_sky_summary.attributes.entity_picture == '/static/images/darksky/weather-partlycloudy.svg' %}
               mdi:weather-partlycloudy
            {% elif states.sensor.dark_sky_summary.attributes.entity_picture == '/static/images/darksky/weather-cloudy.svg' %}
               mdi:weather-cloudy
            {% else %}
               mdi:tag-text-outline
            {% endif %}
         {% else %}
            mdi:tag-text-outline
         {% endif %}

    ups_status:
      friendly_name: Status
      value_template: >-
         {% if states.sensor.ups_status_data %}
            {% if states.sensor.ups_status_data.state == 'OL' %}
               zasilanie sieciowe
            {% elif states.sensor.ups_status_data.state == 'OL CHRG' %}
               ładowanie baterii
            {% elif states.sensor.ups_status_data.state == 'OB DISCHRG' %}
               zasilanie bateryjne
            {% elif states.sensor.ups_status_data.state == 'LB' %}
               słaba bateria
            {% elif states.sensor.ups_status_data.state == 'SD' %}
               wyłączanie
            {% else %}
               {{ states.sensor.ups_status_data.state }}
            {% endif %}
         {% else %}
            unknown
         {% endif %}
